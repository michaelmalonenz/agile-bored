<template>
  <require from="./status-column"></require>
  <dragula-and-drop moves.call="canMove(item, source, handle, sibling)"
    drop-fn.call="dropIssue(item, target, source, sibling, itemVM, siblingVM)">
  </dragula-and-drop>
  <create-issue-button></create-issue-button>
  <div class="main-content">
    <div css="display: grid; grid-template-columns: repeat(${statuses.length}, 1fr); margin-right: 16px; margin-left: 5px;">
      <div class="status-name" repeat.for="status of statuses">${status.name}</div>
    </div>
    <div class="status-cols-area container-fluid">
      <div repeat.for="parent of parentIssues">
        <div class="row issue-title">
          <div class="col-xs-12"><h4>${parent.issue.title}</h4></div>
        </div>
        <div css="display: grid; grid-template-columns: repeat(${statuses.length}, 1fr);">
          <div class="status-col drag-source drop-target" as-element="status-col"
            issues.bind="parent.issue.children" status.bind="status" repeat.for="status of statuses">
          </div>
        </div>
      </div>
      <div class="row issue-title" if.bind="haveParentIssues">
        <div class="col-xs-12"><h4>Other Issues</h4></div>
      </div>
      <div css="display: grid; grid-template-columns: repeat(${statuses.length}, 1fr);">
        <div class="status-col drag-source drop-target" as-element="status-col"
          issues.bind="otherIssues" status.bind="status" repeat.for="status of statuses">
        </div>
      </div>
    </div>
  </div>
</template>
